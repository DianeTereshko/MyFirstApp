@using Blog.Areas.Admin.ViewComponents
@using Blog.Areas.Main.ViewComponents
@model PagedResult<ArticleDetail>
@{
    ViewData["Title"] = "Article";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}

<h1>Article</h1>
<a asp-area="Admin" asp-controller="Default" asp-action="AddArticle" class="w3-button w3-small w3-padding w3-ext-animate-button">Добавить статью</a>




@{
    var count = 1;

}
@foreach (var articleDetail in Model.Results)
{
    count++;



    <div class="w3-medium w3-container w3-padding-16">
        <div>
            Id Статьи: @articleDetail.Id 
        </div>
        <div>
            Название статьи: @articleDetail.Name <span class="w3-badge">@articleDetail.Comment.Count</span>
        </div>
        <div>
            <a href="#" onclick="Toggle(@articleDetail.Id@(count))" class="w3-button w3-green w3-small w3-ext-animate-button">Показать комментарии</a>
            <a asp-area="Admin" asp-controller="Default" asp-action="EditArticle" asp-route-id="@articleDetail.Id" class="w3-button w3-small w3-ext-animate-button">Редактировать</a>
            <a asp-area="Admin" asp-controller="Default" asp-action="DeleteArticle" asp-route-id="@articleDetail.Id" class="w3-button w3-small w3-ext-animate-button">Удалить</a>

        </div>

    </div>



    <table id="@articleDetail.Id@(count)" class="w3-hide w3-table-all">
        <tr>
            <th>Id комментария</th>
            <th>Дата</th>
            <th>Имя пользователя</th>
            <th>Сообщение</th>
            <th>Удаление</th>
            <th>Редактирование</th>
        </tr>
        @foreach (var comment in articleDetail.Comment)
        {



            <tr>

                <td>@comment.Id</td>
                <td>@comment.Date</td>
                <td>@comment.UserName</td>
                <td>@comment.Message</td>
                <td><a asp-area="Admin" asp-controller="Default" asp-action="EditComment" asp-route-id="@comment.Id" class="w3-button w3-small w3-ext-animate-button">Редактировать</a></td>
                <td><a asp-area="Admin" asp-controller="Default" asp-action="DeleteComment" asp-route-id="@comment.Id" class="w3-button w3-small w3-ext-animate-button">Удалить</a></td>
            </tr>

        }
    </table>
}



<div>
    <div>
        @{ var i = 1; }
        @foreach (var item in Model.Results)
        {
            var rowNo = (Model.CurrentPage - 1) * Model.PageSize + i;
            i++;
        }

        @(await Component.InvokeAsync<ArticlePager>(Model))
    </div>
</div>

<script>
    function Toggle(id) {
        var x = document.getElementById(id);
        if (x.className.indexOf("w3-show") == -1) {
            x.className += " w3-show";
        } else {
            x.className = x.className.replace(" w3-show", "");
        }
    }
</script>
